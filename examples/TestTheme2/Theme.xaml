<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:controls="clr-namespace:ClassIsland.Controls;assembly=ClassIsland"
                    xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
                    xmlns:ci="http://classisland.tech/schemas/xaml/core"
                    xmlns:system="clr-namespace:System;assembly=mscorlib"
                    xmlns:classIsland="clr-namespace:ClassIsland;assembly=ClassIsland">
    <Style TargetType="{x:Type ci:ComponentPresenter}" >
        <Style.Resources>
            <ci:SolidColorBrushToColorConverter x:Key="SolidColorBrushToColorConverter"/>
        </Style.Resources>
        <Style.Triggers>
            <Trigger Property="IsRootComponent" Value="True">
                <Setter Property="Template" >
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type ci:ComponentPresenter}">
                            <Grid Margin="0 4 0 4">
                                <Border CornerRadius="10" Padding="10 0"
                                        Height="40"
                                        BorderBrush="{DynamicResource PrimaryHueMidBrush}" BorderThickness="1"
                                        >
                                    <Border.Effect>
                                        <DropShadowEffect BlurRadius="8" ShadowDepth="0" Opacity="1"  Color="{Binding BorderBrush, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Border}, Converter={StaticResource SolidColorBrushToColorConverter}}"/>
                                    </Border.Effect>
                                </Border>
                                <Border CornerRadius="10" Padding="10 0"
                                        Background="#88111111" 
                                        Height="40"
                                        BorderBrush="{DynamicResource PrimaryHueMidBrush}" BorderThickness="1"
                                        >
                                    <Grid>
                                        <ContentPresenter Content="{Binding Content, RelativeSource={RelativeSource AncestorType= ci:ComponentPresenter}}" />
                                    </Grid>   
                                </Border>
                            </Grid>
                        </ControlTemplate> 
                    </Setter.Value>
                </Setter>  
            
            </Trigger>
        </Style.Triggers>
    </Style>

    <!-- 覆盖行容器外观，可以通过修改其中的控件模板来自定义行容器外观 -->
    <Style BasedOn="{StaticResource MainWindowLineBaseStyle}" TargetType="{x:Type controls:MainWindowLine}">
        <Style.Resources>
             <!-- 行容器高度 -->
            <system:Double x:Key="IslandContainerHeight">NaN</system:Double>

            <!-- 行容器控件模板 -->
            <ControlTemplate x:Key="MainWindowLineMinControlTemplate">
                <Grid
                    ClipToBounds="True"
                    Style="{StaticResource DockingStyle}">
                    <Grid x:Name="PART_GridWrapper" ClipToBounds="True"
                        Height="{DynamicResource IslandContainerHeight}"
                        SnapsToDevicePixels="True"
                        Style="{StaticResource DockingStyle}">

                        <Grid Height="{DynamicResource IslandContainerHeight}"
                            x:Name="GridContentRoot"
                            Margin="12 0">
                            <ContentPresenter
                                Content="{Binding Content, RelativeSource={RelativeSource AncestorType=controls:MainWindowLine}}" />
                        </Grid>
                    </Grid>
                </Grid>
            </ControlTemplate>

            <!-- 完整行容器控件模板 -->
            <ControlTemplate x:Key="MainWindowLineFullControlTemplate">
                <Grid>
                    <Grid.Effect>
                        <DropShadowEffect BlurRadius="8" Direction="0" 
                                        ShadowDepth="0" Opacity="0"
                                        x:Name="RootDropShadowEffect"
                                        Color="Black"/>
                    </Grid.Effect>
                    <Grid
                        ClipToBounds="True"
                        Style="{StaticResource DockingStyle}">
                        <!-- Background -->
                        <Border x:Name="BackgroundBorderOverlay"
                                Style="{StaticResource BackgroundBorderStyle}"
                                Width="{Binding ActualWidth, ElementName=BackgroundBorder, Mode=OneWay}"
                                Opacity="0"
                                SnapsToDevicePixels="True"
                                Height="{DynamicResource IslandContainerHeight}">
                        </Border>
                        <Grid
                            Style="{StaticResource DockingStyle}"
                            Width="{Binding BackgroundWidth, Mode=OneWay, RelativeSource={RelativeSource FindAncestor, AncestorType=controls:MainWindowLine}}"
                            Height="{DynamicResource IslandContainerHeight}"
                            SnapsToDevicePixels="True"
                            ClipToBounds="True">
                            <materialDesign:ColorZone x:Name="BackgroundBorderOverlayMask" Mode="PrimaryMid"
                                                    VerticalAlignment="Stretch"
                                                    RenderTransformOrigin="0.5,0.5">
                                <materialDesign:ColorZone.RenderTransform>
                                    <TransformGroup>
                                        <ScaleTransform />
                                        <SkewTransform />
                                        <RotateTransform />
                                        <TranslateTransform Y="-60" />
                                    </TransformGroup>
                                </materialDesign:ColorZone.RenderTransform>
                            </materialDesign:ColorZone>
                        </Grid>

                        <Grid x:Name="PART_GridWrapper" ClipToBounds="True"
                            Height="{DynamicResource IslandContainerHeight}"
                            SnapsToDevicePixels="True"
                            Style="{StaticResource DockingStyle}">

                            <Grid Height="{DynamicResource IslandContainerHeight}"
                                x:Name="GridContentRoot"
                                Margin="12 0">
                                <ContentPresenter
                                    Content="{Binding Content, RelativeSource={RelativeSource AncestorType=controls:MainWindowLine}}" />
                            </Grid>

                            <!-- Overlay View -->
                            <Grid x:Name="GridOverlay"
                                SnapsToDevicePixels="True"
                                ClipToBounds="True">
                                <Border CornerRadius="20"
                                        ClipToBounds="True">

                                    <ProgressBar VerticalAlignment="Stretch"
                                                Maximum="1"
                                                Value="{Binding NotificationProgressBarValue, RelativeSource={RelativeSource AncestorType=classIsland:MainWindow}}"
                                                x:Name="OverlayTimeProgressBar"
                                                materialDesign:TransitionAssist.DisableTransitions="True"
                                                Height="{Binding Height, ElementName=PART_GridWrapper}"
                                                Foreground="{DynamicResource MaterialDesignBody}"
                                                Background="Transparent"
                                                BorderBrush="Transparent"
                                                Opacity="0.16">
                                    </ProgressBar>
                                </Border>
                                <ContentPresenter
                                    Content="{Binding ViewModel.CurrentOverlayElement, RelativeSource={RelativeSource FindAncestor, AncestorType=classIsland:MainWindow}}" />

                            </Grid>

                            <!-- Mask -->
                            <materialDesign:ColorZone x:Name="OverlayMask" Mode="PrimaryMid" HorizontalAlignment="Stretch"
                                                    VerticalAlignment="Stretch"
                                                    RenderTransformOrigin="0.5,0.5"
                                                    SnapsToDevicePixels="True">
                                <materialDesign:ColorZone.RenderTransform>
                                    <TransformGroup>
                                        <ScaleTransform />
                                        <SkewTransform />
                                        <RotateTransform />
                                        <TranslateTransform Y="-60" />
                                    </TransformGroup>
                                </materialDesign:ColorZone.RenderTransform>
                                <ContentPresenter x:Name="OverlayMaskContent"
                                                Content="{Binding ViewModel.CurrentMaskElement, RelativeSource={RelativeSource FindAncestor, AncestorType=classIsland:MainWindow}}" />
                            </materialDesign:ColorZone>
                        </Grid>
                    </Grid>
                </Grid>
            </ControlTemplate>
        </Style.Resources>
        <!-- <Setter Property="Height" Value="60"/> -->
    </Style>

</ResourceDictionary>